# Forward Reader - 智能合并转发分析插件

一个为 [AstrBot](https://github.com/Soulter/AstrBot) 设计的插件，可以像真人一样，智能地分析和总结 QQ 中的合并转发消息，并与用户进行自然语言交互。

## ✨ 功能特性

-   **无指令交互**: 无需任何指令，插件会自动感知并处理与合并转发相关的消息。
-   **智能场景识别**:
    -   **直接分析**: 当有用户发送合并转发消息时，可配置自动进行分析总结。
    -   **上下文分析**: 当用户回复或引用一条合并转发消息并提问时（如“总结一下”、“这聊了啥？”），插件能理解其意图，并结合聊天记录和问题进行回答。
-   **多模态支持**: 能够提取并发送聊天记录中的文本和图片给 LLM 进行综合分析。
-   **高度可配置**: 用户可以自定义系统提示词 (System Prompt)，并独立开关两种自动分析场景，以平衡功能性与资源消耗。

## 🚀 安装

1.  下载插件。
2.  将 `astrbot_plugin_forward_reader` 文件夹放入 AstrBot 的 `plugins` 目录。
3.  重启 AstrBot。

## 📖 使用方法

插件的核心是自然语言交互，无需记忆复杂指令。

### 场景一：直接分析合并转发

1.  在插件配置中，开启“自动分析直接发送的转发消息”。
2.  当任何人在群里或私聊中发送一条合并转发消息时，机器人会自动对其内容进行总结和分析，并发送结果。

### 场景二：回复并分析合并转发

1.  默认情况下，“自动分析被引用的转发消息”是开启的。
2.  在聊天中找到一条你感兴趣的合并转发消息。
3.  **回复** 这条消息，并提出你的问题，例如：
    -   `这个聊了些啥？`
    -   `请帮我总结一下重点。`
    -   `谁提到了“预算”？`
4.  机器人会理解你的问题，结合它看到的聊天记录，给出智能回答。

## ⚙️ 配置项

你可以在 AstrBot 的插件配置页面中找到本插件的配置。**注意：修改配置后，需要重启 AstrBot 或重载插件才能生效。**

-   **自动分析直接发送的转发消息**
    -   **类型**: 开关 (bool)
    -   **作用**: 开启后，任何用户直接发送的合并转发消息都会被自动分析。
    -   **注意**: 在活跃的群聊中，这可能会消耗大量的 LLM 调用资源，请谨慎开启。
    -   **默认值**: `关闭 (false)`

-   **自动分析被引用的转发消息**
    -   **类型**: 开关 (bool)
    -   **作用**: 开启后，当用户回复一条合并转发消息并提问时，机器人会自动进行分析。这是推荐的使用方式。
    -   **默认值**: `开启 (true)`

-   **用于分析转发消息的系统提示词 (System Prompt)**
    -   **作用**: 定义 LLM 在分析聊天记录时扮演的角色和遵循的规则。你可以根据自己的需求进行调整，以获得更好的分析效果。
    -   **默认值**: `你是一个专业的聊天记录分析助手。你的任务是根据用户提供的聊天记录（可能包含文字和图片）和用户的提问，进行总结和回答。如果用户没有明确提问，请对聊天记录进行一个全面的摘要。聊天记录的格式为 '发送者: 内容'。`

## ⚠️ 注意

-   本插件主要为 QQ 平台的 `aiocqhttp` 适配器开发和测试，依赖其提供的 `get_msg` 和 `get_forward_msg` API。
-   分析结果的质量完全取决于你所配置的 LLM 模型的能力。一个强大的多模态模型会带来更好的体验。

## 👨‍💻 作者

-   EraAsh

## 🌟 支持

如果觉得这个插件对你有帮助，不妨点个 Star 鼓励一下作者吧！

[![GitHub stars](https://img.shields.io/github/stars/EraAsh/astrbot_plugin_forward_reader.svg?style=social&label=Star)](https://github.com/EraAsh/astrbot_plugin_forward_reader)

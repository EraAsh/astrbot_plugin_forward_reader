{
  "enable_smart_detection": {
    "description": "启用智能感知模式",
    "type": "bool",
    "default": true,
    "hint": "开启后，插件会自动感知用户对合并转发消息的分析意图，无需显式指令。建议保持开启。"
  },
  "enable_direct_analysis": {
    "description": "自动分析直接发送的合并转发",
    "type": "bool",
    "default": false,
    "hint": "开启后，用户直接发送的合并转发消息将被自动分析并给出评价。分析时不会携带之前的对话上下文，避免前言不对后语。注意：在活跃群聊中可能产生大量LLM调用。"
  },
  "enable_reply_analysis": {
    "description": "分析被引用的合并转发",
    "type": "bool",
    "default": true,
    "hint": "开启后，当用户引用/回复一条合并转发消息时，插件会自动感知并分析。这是最推荐的使用方式。"
  },
  "enable_proactive_reply": {
    "description": "主动回复模式",
    "type": "bool",
    "default": false,
    "hint": "开启后，当用户@机器人或触发唤醒词发送合并转发时，Bot会主动分析。"
  },
  "sensitivity": {
    "description": "智能感知灵敏度",
    "type": "float",
    "default": 0.7,
    "hint": "自然语言触发识别的灵敏度（0.0-1.0），值越高越容易触发分析。默认0.7为平衡值。"
  },
  "max_messages": {
    "description": "最大处理消息数",
    "type": "int",
    "default": 200,
    "hint": "单次分析最多处理的聊天记录条数，超过此数量将截断。防止过长记录导致LLM超时。"
  },
  "show_thinking": {
    "description": "显示思考提示",
    "type": "bool",
    "default": true,
    "hint": "开启后，Bot会在分析前发送'让我看看...'等自然语言提示，模拟真人思考过程。"
  },
  "multimodal_config": {
    "description": "多模态分析配置专区",
    "type": "object",
    "items": {
      "enable_multimodal": {
        "description": "启用多模态分析",
        "type": "bool",
        "default": true,
        "hint": "开启后，如果合并消息中包含图片/视频，会尝试使用多模态模型进行分析。"
      },
      "vision_provider_id": {
        "description": "多模态视觉模型提供商（可选）",
        "type": "string",
        "hint": "从 AstrBot 提供商列表中手动选择用于多模态分析的提供商。留空时沿用 AstrBot 当前默认提供商。",
        "_special": "select_provider",
        "default": ""
      },
      "max_images": {
        "description": "最大图片数量",
        "type": "int",
        "default": 5,
        "hint": "单次分析最多处理的图片数量。过多的图片可能导致API请求失败或消耗大量Token。"
      },
      "max_videos": {
        "description": "最大视频数量",
        "type": "int",
        "default": 2,
        "hint": "单次分析最多处理的视频数量。视频分析消耗大量Token，建议保持较低值。"
      },
      "image_quality": {
        "description": "图片质量模式",
        "type": "string",
        "options": ["auto", "high", "low"],
        "default": "auto",
        "hint": "图片发送给LLM的质量模式。high=高清（消耗更多Token），low=低清（节省Token），auto=根据内容自动选择。"
      },
      "batch_process": {
        "description": "启用批量预处理",
        "type": "bool",
        "default": true,
        "hint": "开启后，多张图片会批量预处理并生成统一摘要，避免逐张调用导致的Token浪费。"
      },
      "media_request_timeout": {
        "description": "媒体探测超时(秒)",
        "type": "float",
        "default": 10.0,
        "hint": "图片URL可用性探测请求超时时间。QQ临时资源建议8~15秒。"
      },
      "media_retry_times": {
        "description": "媒体探测重试次数",
        "type": "int",
        "default": 2,
        "hint": "图片URL探测失败时的重试次数。值越高越稳，但耗时会增加。"
      }
    }
  },
  "performance_config": {
    "description": "性能优化配置专区",
    "type": "object",
    "items": {
      "enable_deduplication": {
        "description": "启用消息去重",
        "type": "bool",
        "default": true,
        "hint": "开启后，通过消息ID哈希缓存防止同一内容被多次分析，减少重复Token消耗。"
      },
      "dedup_ttl": {
        "description": "去重缓存有效期(秒)",
        "type": "int",
        "default": 3600,
        "hint": "消息ID哈希缓存的有效期，超过此时间后相同消息可再次分析。默认1小时。"
      },
      "auto_analysis_delay": {
        "description": "自动分析延迟(秒)",
        "type": "float",
        "default": 2.0,
        "hint": "自动分析模式的延迟触发时间。在此时间内无新消息才执行分析，避免频繁调用。"
      },
      "token_budget": {
        "description": "Token预算控制",
        "type": "int",
        "default": 4000,
        "hint": "单次分析的最大Token预算，超过后将启用分段摘要策略。0表示无限制。"
      },
      "enable_segmented_summary": {
        "description": "启用分段摘要",
        "type": "bool",
        "default": true,
        "hint": "开启后，超长内容会自动分段处理并生成统一摘要，确保识别过程快速明了。"
      },
      "segment_size": {
        "description": "分段大小(字符)",
        "type": "int",
        "default": 1500,
        "hint": "启用分段摘要时，每段的最大字符数。建议1000-2000之间。"
      }
    }
  },
  "parse_nested_forward": {
    "description": "解析嵌套合并转发",
    "type": "bool",
    "default": true,
    "hint": "开启后，会尝试解析合并转发中嵌套的其他合并转发消息。能分析则分析，无法分析则跳过。"
  },
  "max_nested_depth": {
    "description": "最大嵌套深度",
    "type": "int",
    "default": 3,
    "hint": "解析嵌套合并转发的最大深度，防止无限递归。建议不超过5层。"
  },
  "logging_config": {
    "description": "日志追踪配置专区",
    "type": "object",
    "items": {
      "log_level": {
        "description": "日志级别",
        "type": "string",
        "options": ["DEBUG", "INFO", "WARNING", "ERROR"],
        "default": "INFO",
        "hint": "插件日志输出级别。DEBUG显示所有追踪信息，INFO显示关键节点，WARNING仅显示警告和错误。"
      },
      "enable_performance_log": {
        "description": "启用性能指标日志",
        "type": "bool",
        "default": true,
        "hint": "开启后，会记录LLM调用耗时、Token消耗等性能指标，便于监控插件使用状态。"
      },
      "enable_trace_log": {
        "description": "启用全链路追踪日志",
        "type": "bool",
        "default": false,
        "hint": "开启后，会在消息接收、分析类型判定、资源检测等关键节点输出详细DEBUG日志。"
      }
    }
  }
}
